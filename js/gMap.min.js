function gMap(){this.center={lat:23.661846,lng:120.646877},this.zoom=8}function addObjectInfo(e,t){document.getElementById("infoWindow").style.display="block";var a=document.createElement("table");a.id=t.id+"Info",a.className="striped bordered","point"==t.type&&(a.innerHTML='<thead><tr><th><i class="small red-text material-icons">place</i></th><th>'+t.name+"</th></tr></thead><tbody><tr><td>經緯度:</td><td>("+t.lng+","+t.lat+")</td></tr><tr><td>平面N,E坐標(TWD97):</td><td>("+t.twdN+","+t.twdE+")</td></tr><tr><td>平面N,E坐標(優化TWD97):</td><td>("+t.twdNO+","+t.twdEO+")</td></tr></tbody>"),"polyline"==t.type&&(a.innerHTML='<thead><tr><th><i class="small green-text material-icons">timeline</i></th><th>'+t.name+"</th></tr></thead><tbody><tr><td>路線長度(WGS84)</td><td>"+t.wgs84Length+" (m)</td></tr><tr><td>路線長度(TWD97)</td><td>"+t.twd97Length+" (m)</td></tr><tr><td>路線長度(優化TWD97)</td><td>"+t.twd97LengthO+" (m)</td></tr></tbody>"),"polygon"==t.type&&(a.innerHTML='<thead><tr><th><i class="small blue-text material-icons">crop_5_4</i></th><th>'+t.name+"</th></tr></thead><tbody><tr><td>區域面積(WGS84)</td><td>"+t.wgs84Area+" (m^2) = "+(parseFloat(t.wgs84Area)/3.30578).toFixed(3)+" (坪)</td></tr><tr><td>區域面積(TWD97)</td><td>"+t.twd97Area+" (m^2) = "+(parseFloat(t.twd97Area)/3.30578).toFixed(3)+" (坪)</td></tr><tr><td>區域面積(優化TWD97)</td><td>"+t.twd97AreaO+" (m^2) = "+(parseFloat(t.twd97AreaO)/3.30578).toFixed(3)+" (坪)</td></tr></tbody>");var n=document.createElement("a");n.className="btn-floating cyan lighten-2",n.style.top="-18px",n.style.left="-18px",n.style.position="absolute",n.id="infoWindowMovingIcon";var o=document.createElement("i");o.className="material-icons",o.innerHTML="open_with";var l=document.createElement("a");l.className="btn-floating red lighten-2 waves-effect",l.style.top="-18px",l.style.right="-18px",l.style.position="absolute",l.id="infoWindowCloseIconA";var i=document.createElement("i");i.className="material-icons",i.innerHTML="clear",n.appendChild(o),l.appendChild(i),document.getElementById("infoWindow").innerHTML="",document.getElementById("infoWindow").appendChild(a),document.getElementById("infoWindow").appendChild(n),document.getElementById("infoWindow").appendChild(l),document.getElementById("infoWindowCloseIconA").addEventListener("click",function(){document.getElementById("infoWindow").style.display="none"})}function twoDArray(e){for(var t=[],a=0;e>a;a++)t[a]=new Array;return t}function converTo97(e,t,a){e=e*Math.PI/180,t=t*Math.PI/180;var n=Math.pow(Math.tan(e),2),o=coor97.eplus2*Math.pow(Math.cos(e),2),l=(t-121*Math.PI/180)*Math.cos(e),i=coor97.a/Math.sqrt(1-coor97.e2*Math.pow(Math.sin(e),2)),d=coor97.a*((1-coor97.e2/4-3*coor97.e2*coor97.e2/64-5*coor97.e2*coor97.e2*coor97.e2/256)*e-(3*coor97.e2/8+3*coor97.e2*coor97.e2/32+45*coor97.e2*coor97.e2*coor97.e2/1024)*Math.sin(2*e)+(15*coor97.e2*coor97.e2/256+45*coor97.e2*coor97.e2*coor97.e2/1024)*Math.sin(4*e)-35*coor97.e2*coor97.e2*coor97.e2/3072*Math.sin(6*e)),s=coor97.X0+a*i*(l+(1-n+o)*l*l*l/6+(5-18*n+n*n+72*o-58*coor97.eplus2)*Math.pow(l,5)/120),r=coor97.Y0+a*(d+i*Math.tan(e)*(l*l/2+(5-n+9*o+4*o*o)*Math.pow(l,4)/24+(61-58*n+n*n+600*o-300*coor97.eplus2)*Math.pow(l,6)/720));return{E:s.toFixed(6),N:r.toFixed(6)}}function getPathLength(e,t){for(var a=0,n=0,o=0;o<e.length-1;o++)a+=Math.sqrt(Math.pow(e[o+1][0]-e[o][0],2)+Math.pow(e[o+1][1]-e[o][1],2)),n+=Math.sqrt(Math.pow(t[o+1][0]-t[o][0],2)+Math.pow(t[o+1][1]-t[o][1],2));return{twd97length:a.toFixed(6),twd97lengtho:n.toFixed(6)}}function getArea(e){for(var t=0,a=0,n=e.length-1;n>-1;n--)n>-1&&(n==e.length-1?(t+=e[n][0]*e[0][1],a+=e[n][1]*e[0][0]):(t+=e[n][0]*e[n+1][1],a+=e[n][1]*e[n+1][0]));return(Math.abs(t-a)/2).toFixed(6)}function reflashPolyline(e,t,a,n){for(var o=e.getPath(),l=twoDArray(o.length),i=twoDArray(o.length),d=0;d<o.length;d++)l[d][0]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.9999).E,l[d][1]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.9999).N,i[d][0]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.999941).E,i[d][1]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.999941).N;var s=google.maps.geometry.spherical.computeLength(e.getPath()),r=getPathLength(l,i);e.polylineId=e.polylineId,e.name="Polyline"+e.polylineId,e.type="polyline",e.wgs84Length=s.toFixed(6),e.twd97Length=r.twd97length,e.twd97LengthO=r.twd97lengtho,e.twd97Path=l,e.twd97PathO=i,e.latlngPath=e.getPath(),t={id:e.polylineId,name:e.name,type:"polyline",wgs84Length:e.wgs84Length,twd97Length:e.twd97Length,twd97LengthO:e.twd97LengthO},addObjectInfo("infoWindow",t),n[e.polylineId]=e,a.setPosition({lat:o.getAt(0).lat(),lng:o.getAt(0).lng()})}function addNewPoint(e,t,a,n){e.pointId=a,e.type="point",e.name="Point"+a,e.lng=e.getPosition().lng().toFixed(6),e.lat=e.getPosition().lat().toFixed(6),e.wgsE=converTo97(e.lat,e.lng,.9996).E,e.wgsN=converTo97(e.lat,e.lng,.9996).N,e.twdE=converTo97(e.lat,e.lng,.9999).E,e.twdN=converTo97(e.lat,e.lng,.9999).N,e.twdEO=converTo97(e.lat,e.lng,.999941).E,e.twdNO=converTo97(e.lat,e.lng,.999941).N,t.push(e),addObjectInfo("infoWindow",{id:e.pointId,name:e.name,type:"point",lng:e.lng,lat:e.lat,wgsE:e.wgsE,wgsN:e.wgsN,twdE:e.twdE,twdN:e.twdN,twdNO:e.twdNO,twdEO:e.twdEO}),google.maps.event.addListener(e,"click",function(){addObjectInfo("infoWindow",{id:e.pointId,name:e.name,type:"point",lng:e.lng,lat:e.lat,wgsE:e.wgsE,wgsN:e.wgsN,twdE:e.twdE,twdN:e.twdN,twdNO:e.twdNO,twdEO:e.twdEO})}),google.maps.event.addListener(e,"rightclick",function(){e.setMap(null),t.splice(e.pointId,1),document.getElementById("infoWindow").style.display="none"});var o=new google.maps.InfoWindow({content:'<div class="red-text" style="font-weight:800">'+e.name+"</div>"});o.open(n,e),google.maps.event.addListener(o,"domready",function(){$(".gm-style-iw").next("div").hide()})}function addNewLine(e,t,a,n,o){for(var l=e.getPath(),i=twoDArray(l.length),d=twoDArray(l.length),s=0;s<l.length;s++)i[s][0]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.9999).E,i[s][1]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.9999).N,d[s][0]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.999941).E,d[s][1]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.999941).N;var r=google.maps.geometry.spherical.computeLength(e.getPath()),c=getPathLength(i,d);e.polylineId=n,e.name="Polyline"+n,e.type="polyline",e.wgs84Length=r.toFixed(6),e.twd97Length=c.twd97length,e.twd97LengthO=c.twd97lengtho,e.twd97Path=i,e.twd97PathO=d,e.latlngPath=e.getPath();var m={id:e.polylineId,name:e.name,type:"polyline",wgs84Length:e.wgs84Length,twd97Length:e.twd97Length,twd97LengthO:e.twd97LengthO};addObjectInfo("infoWindow",m),google.maps.event.addListener(e,"click",function(){addObjectInfo("infoWindow",m)}),google.maps.event.addListener(e.getPath(),"set_at",function(){reflashPolyline(e,m,p,a)}),google.maps.event.addListener(e.getPath(),"insert_at",function(){reflashPolyline(e,m,p,a)});var p=new google.maps.Marker({position:{lat:l.getAt(0).lat(),lng:l.getAt(0).lng()},map:t,opacity:0});o.push(p),google.maps.event.addListener(e,"rightclick",function(){e.setMap(null),a.splice(e.polylineId,1),p.setMap(null),o.splice(e.polylineId,1),document.getElementById("infoWindow").style.display="none"});var g=new google.maps.InfoWindow({content:'<div class="green-text" style="font-weight:800">'+e.name+"</div>"});g.open(t,p),google.maps.event.addListener(g,"domready",function(){$(".gm-style-iw").next("div").hide()})}function addNewPolyline(e,t,a,n,o){for(var l=e.getPath(),i=twoDArray(l.length),d=twoDArray(l.length),s=0;s<l.length;s++)i[s][0]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.9999).E,i[s][1]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.9999).N,d[s][0]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.999941).E,d[s][1]=converTo97(l.getAt(s).lat(),l.getAt(s).lng(),.999941).N;var r=google.maps.geometry.spherical.computeArea(e.getPath()),c=getArea(i),m=getArea(d);e.polygonId=n,e.name="Polygon"+n,e.type="polygon",e.wgs84Area=r.toFixed(6),e.twd97Area=c,e.twd97AreaO=m,e.twd97Path=i,e.twd97PathO=d;var p={id:e.polygonId,name:e.name,type:"polygon",wgs84Area:e.wgs84Area,twd97Area:e.twd97Area,twd97AreaO:e.twd97AreaO};addObjectInfo("infoWindow",p),google.maps.event.addListener(e,"click",function(){addObjectInfo("infoWindow",p)}),google.maps.event.addListener(e.getPath(),"set_at",function(){reflashPolygon(e,p,g,a)}),google.maps.event.addListener(e.getPath(),"insert_at",function(){reflashPolygon(e,p,g,a)});var g=new google.maps.Marker({position:{lat:l.getAt(0).lat(),lng:l.getAt(0).lng()},map:t,opacity:0});o.push(g),google.maps.event.addListener(e,"rightclick",function(){e.setMap(null),a.splice(e.polygonId,1),g.setMap(null),o.splice(e.polygonId,1),document.getElementById("infoWindow").style.display="none"});var u=new google.maps.InfoWindow({content:'<div class="blue-text" style="font-weight:800">'+e.name+"</div>"});u.open(t,g),google.maps.event.addListener(u,"domready",function(){$(".gm-style-iw").next("div").hide()})}function reflashPolygon(e,t,a,n){for(var o=e.getPath(),l=twoDArray(o.length),i=twoDArray(o.length),d=0;d<o.length;d++)l[d][0]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.9999).E,l[d][1]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.9999).N,i[d][0]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.999941).E,i[d][1]=converTo97(o.getAt(d).lat(),o.getAt(d).lng(),.999941).N;var s=google.maps.geometry.spherical.computeArea(e.getPath()),r=getArea(l),c=getArea(i);e.polygonId=e.polygonId,e.name="Polygon"+e.polygonId,e.type="polygon",e.wgs84Area=s.toFixed(6),e.twd97Area=r,e.twd97AreaO=c,e.twd97Path=l,e.twd97PathO=i,t={id:e.polygonId,name:e.name,type:"polygon",wgs84Area:e.wgs84Area,twd97Area:e.twd97Area,twd97AreaO:e.twd97AreaO},addObjectInfo("infoWindow",t),n[e.polygonId]=e,a.setPosition({lat:o.getAt(0).lat(),lng:o.getAt(0).lng()})}function convertToLatLng(e,t,a){var n=0,o=(1-Math.sqrt(1-coor97.e2))/(1+Math.sqrt(1-coor97.e2)),l=(t-n)/(coor97.a*a*(1-coor97.e2/4-3*coor97.e2*coor97.e2/64-5*coor97.e2*coor97.e2*coor97.e2/256)),i=l+(3*o/2-27*Math.pow(o,3)/32)*Math.sin(2*l)+(21*o*o/16-55*Math.pow(o,4)/32)*Math.sin(4*l)+151*Math.pow(o,3)/96*Math.sin(6*l)+1097*Math.pow(o,4)/512*Math.sin(8*l),d=coor97.a/Math.sqrt(1-coor97.e2*Math.pow(Math.sin(i),2)),s=Math.pow(Math.tan(i),2),r=coor97.eplus2*Math.pow(Math.cos(i),2),c=coor97.a*(1-coor97.e2)/Math.pow(1-coor97.e2*Math.pow(Math.sin(i),2),1.5),m=(e-25e4)/(d*a);return{Lat:180*(i-d*Math.tan(i)/c*(m*m/2-(5+3*s+10*r-4*r*r-9*coor97.eplus2)*Math.pow(m,4)/24+(61+90*s+298*r+45*s*s-252*coor97.eplus2-3*r*r)*Math.pow(m,6)/720))/Math.PI,Lng:121+(m-(1+2*s+r)*m*m*m/6+(5-2*r+28*s-3*r*r+8*coor97.eplus2+24*s*s)*Math.pow(m,5)/120)/Math.cos(i)*180/Math.PI}}function getExtentedMapImage(e,t,a,n,o,l,i){var d=[];d[0]={lat:e.lat-t,lng:e.lng+a},d[1]={lat:e.lat,lng:e.lng+a},d[2]={lat:e.lat+t,lng:e.lng+a},d[3]={lat:e.lat-t,lng:e.lng},d[4]={lat:e.lat+t,lng:e.lng},d[5]={lat:e.lat-t,lng:e.lng-a},d[6]={lat:e.lat,lng:e.lng-a},d[7]={lat:e.lat+t,lng:e.lng-a};for(var s=[],r=0;8>r;r++)s[r]="https://maps.googleapis.com/maps/api/staticmap?center="+d[r].lat+","+d[r].lng+"&zoom="+l+"&scale=2&size="+o+"x"+n+"&maptype="+i+"&format=jpg";return s}function polygonZoomChanged(e,t,a,n){$("#toast-container").remove();var o=e.getBounds().getNorthEast(),l=e.getBounds().getSouthWest(),i=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(o.lat(),o.lng()),new google.maps.LatLng(o.lat(),l.lng())),d=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(o.lat(),o.lng()),new google.maps.LatLng(l.lat(),o.lng())),s={lat:e.getBounds().getCenter().lat(),lng:e.getBounds().getCenter().lng()};if(a=(Math.abs(i)/zoomScale[t.getZoom()]/.00027608695+35).toFixed(0),n=(Math.abs(d)/zoomScale[t.getZoom()]/.00027608695+35).toFixed(0),a>=640||n>=640){var r=Math.abs(640*zoomScale[t.getZoom()]*.00027608695),c=Math.abs(640*zoomScale[t.getZoom()]*.00027608695),m=convertToLatLng(c+25e4,r,.9996),p=new google.maps.LatLng(s.lat-m.Lat/2,s.lng-(m.Lng-121)/2),g=new google.maps.LatLng(s.lat+m.Lat/2,s.lng+(m.Lng-121)/2),u=new google.maps.LatLngBounds(p,g);e.setBounds(u),a=640,n=640}"https://maps.googleapis.com/maps/api/staticmap?center="+s.lat+","+s.lng+"&zoom="+t.getZoom()+"&scale=2&size="+a+"x"+n+"&maptype="+t.getMapTypeId()+"&format=jpg";$toastContent=$("<span>影像大小: "+2*a+" X "+2*n+'&nbsp<a id="showMapImage" class="btn btn-floating waves-effect"><i class="material-icons">pageview</i></a><a id="exporMapImage" class="blue btn btn-floating waves-effect"><i class="material-icons">cloud_download</i></a></span>'),Materialize.toast($toastContent),$(".toast").css("borderRadius","24px"),document.getElementById("exporMapImage").addEventListener("click",function(){document.getElementById("mapImageUrlInput").value="https://maps.googleapis.com/maps/api/staticmap?center="+s.lat+","+s.lng+"&zoom="+t.getZoom()+"&scale=2&size="+a+"x"+n+"&maptype="+t.getMapTypeId()+"&format=jpg&lang=zh-tw",document.getElementById("mapImageUrlForm").submit()}),document.getElementById("showMapImage").addEventListener("click",function(){document.getElementById("mapImageImg").src="https://maps.googleapis.com/maps/api/staticmap?center="+s.lat+","+s.lng+"&zoom="+t.getZoom()+"   &scale=2&size="+a+"x"+n+"&maptype="+t.getMapTypeId()+"&format=jpg&lang=zh-tw",$("#mapViewDiv").openModal()}),$(".click-to-toggle li a").on("click",function(){"captureImage"!=$(this).attr("id")&&"mapTypeRoad"!=$(this).attr("id")&&"mapTypeSatellite"!=$(this).attr("id")&&"mapTypeMix"!=$(this).attr("id")&&"movingMode"!=$(this).attr("id")&&$("#toast-container").remove()})}function collectGeometryData(e,t,a){for(var n=twoDArray(e.length),o=twoDArray(t.length),l=twoDArray(a.length),i=0;i<e.length;i++)n[i][0]=e[i].name,n[i][1]=[e[i].lng,e[i].lat],n[i][2]=[e[i].twdE,e[i].twdN],n[i][3]=[e[i].twdEO,e[i].twdNO];for(var i=0;i<t.length;i++){o[i][0]=new Array,o[i][1]=new Array,o[i][2]=new Array,o[i][0][0]="Polyline"+t[i].polylineId,o[i][1][0]="Polyline"+t[i].polylineId,o[i][2][0]="Polyline"+t[i].polylineId;for(var d=0;d<t[i].getPath().length;d++)o[i][0][d+1]=[t[i].getPath().getAt(d).lng(),t[i].getPath().getAt(d).lat()],o[i][1][d+1]=t[i].twd97Path[d],o[i][2][d+1]=t[i].twd97PathO[d]}for(var i=0;i<a.length;i++){l[i][0]=new Array,l[i][1]=new Array,l[i][2]=new Array,l[i][0][0]="Polygon"+a[i].polygonId,l[i][1][0]="Polygon"+a[i].polygonId,l[i][2][0]="Polygon"+a[i].polygonId;for(var d=0;d<a[i].getPath().length;d++)l[i][0][d+1]=[a[i].getPath().getAt(d).lng(),a[i].getPath().getAt(d).lat()],l[i][1][d+1]=a[i].twd97Path[d],l[i][2][d+1]=a[i].twd97PathO[d]}return[n,o,l]}function exportGeometryData(e,t){if(e[0].length>0)for(var a="",n=0;n<e[0].length;n++)0==n&&e[0].length>1?a='"point":[['+e[0][n][t+1]+"],":n<e[0].length-1?a+="["+e[0][n][t+1]+"],":n==e[0].length-1&&(a+="["+e[0][n][t+1]+"]]"),0==n&&1==e[0].length&&(a='"point":[['+e[0][n][t+1]+"]]");else var a='"point":[]';if(e[1].length>0)for(var o='"polyline":[',n=0;n<e[1].length;n++){if(n<e[1].length-1){o+='[["'+e[1][n][t][0]+'"],';for(var l=1;l<e[1][n][t].length;l++)l<e[1][n][t].length-1&&(o+="["+e[1][n][t][l]+"],"),l==e[1][n][t].length-1&&(o+="["+e[1][n][t][l]+"]],")}if(n==e[1].length-1){o+='[["'+e[1][n][t][0]+'"],';for(var l=1;l<e[1][n][t].length;l++)l<e[1][n][t].length-1&&(o+="["+e[1][n][t][l]+"],"),l==e[1][n][t].length-1&&(o+="["+e[1][n][t][l]+"]]]")}}else var o='"polyline":[]';if(e[2].length>0)for(var i='"polygon":[',n=0;n<e[2].length;n++){if(n<e[2].length-1){i+='[["'+e[2][n][t][0]+'"],';for(var l=1;l<e[2][n][t].length;l++)l<e[2][n][t].length-1&&(i+="["+e[2][n][t][l]+"],"),l==e[2][n][t].length-1&&(i+="["+e[2][n][t][l]+"]],")}if(n==e[2].length-1){i+='[["'+e[2][n][t][0]+'"],';for(var l=1;l<e[2][n][t].length;l++)l<e[2][n][t].length-1&&(i+="["+e[2][n][t][l]+"],"),l==e[2][n][t].length-1&&(i+="["+e[2][n][t][l]+"]]]")}}else var i='"polygon":[]';document.getElementById("dxfExportInput").value="{"+a+","+o+","+i+"}",document.getElementById("dxfExportForm").submit()}gMap.prototype.initMap=function(){var e,t,a=0,n=[],o=0,l=[],i=[],d=0,s=[],r=[],c=document.createElement("div");c.id="mapCanvas",c.style.height=window.innerHeight+"px",c.style.width=window.innerWidth+"px",document.body.appendChild(c),this.map=new google.maps.Map(document.getElementById("mapCanvas"),{center:{lat:this.center.lat,lng:this.center.lng},zoom:this.zoom,disableDefaultUI:!0});var m=this.map,p=this.center,g=document.createElement("div");g.className="fixed-action-btn click-to-toggle horizontal",g.style.bottom="45px",g.style.right="24px",document.body.appendChild(g);var u=document.createElement("a");u.className="btn-floating btn-large red waves-effect waves-light",u.id="toolMenu";var v=document.createElement("i");v.className="large material-icons",v.innerHTML="edit",u.appendChild(v);var h=document.createElement("ul"),y=document.createElement("a");y.className="btn-floating grey darken-3 waves-effect waves-light",y.id="movingMode";var f=document.createElement("i");f.className="material-icons",f.innerHTML="pan_tool";var w=document.createElement("li");y.appendChild(f),w.appendChild(y),h.appendChild(w);var L=document.createElement("a");L.className="btn-floating red waves-effect waves-light",L.id="drawingPoint";var E=document.createElement("i");E.className="material-icons",E.innerHTML="add_location";var b=document.createElement("li"),T=document.createElement("a");T.className="btn-floating red waves-effect waves-light",T.id="removePoint",T.style.position="absolute",T.style.display="none";var M=document.createElement("i");M.className="material-icons white-text",M.innerHTML="delete",T.appendChild(M),document.body.appendChild(T);var C=document.createElement("a");C.className="btn-floating red waves-effect waves-light",C.id="addMultiPoint",C.style.position="absolute",C.style.display="none";var x=document.createElement("i");x.className="material-icons white-text",x.innerHTML="add",C.appendChild(x),document.body.appendChild(C),L.appendChild(E),b.appendChild(L),h.appendChild(b);var I=document.createElement("a");I.className="btn-floating green waves-effect waves-light",I.id="drawingPolyline";var N=document.createElement("i");N.className="material-icons",N.innerHTML="timeline";var O=document.createElement("li"),A=document.createElement("a");A.className="btn-floating green waves-effect waves-light",A.id="removeLine",A.style.position="absolute",A.style.display="none";var k=document.createElement("i");k.className="material-icons white-text",k.innerHTML="delete",A.appendChild(k),document.body.appendChild(A);var P=document.createElement("a");P.className="btn-floating green waves-effect waves-light",P.id="addMultiLine",P.style.position="absolute",P.style.display="none";var H=document.createElement("i");H.className="material-icons white-text",H.innerHTML="add",P.appendChild(H),document.body.appendChild(P),I.appendChild(N),O.appendChild(I),h.appendChild(O);var B=document.createElement("a");B.className="btn-floating blue waves-effect waves-light",B.id="drawingPolygon";var W=document.createElement("i");W.className="material-icons",W.innerHTML="crop_5_4";var D=document.createElement("li"),z=document.createElement("a");z.className="btn-floating blue waves-effect waves-light",z.id="removePolygon",z.style.position="absolute",z.style.display="none";var F=document.createElement("i");F.className="material-icons white-text",F.innerHTML="delete",z.appendChild(F),document.body.appendChild(z);var R=document.createElement("a");R.className="btn-floating blue waves-effect waves-light",R.id="addMultiPolygon",R.style.position="absolute",R.style.display="none";var _=document.createElement("i");_.className="material-icons white-text",_.innerHTML="add",R.appendChild(_),document.body.appendChild(R),B.appendChild(W),D.appendChild(B),h.appendChild(D);var S=document.createElement("a");S.className="btn-floating yellow darken-2 waves-effect waves-light",S.id="captureImage";var Z=document.createElement("i");Z.className="material-icons",Z.innerHTML="camera_alt";var G=document.createElement("li");S.appendChild(Z),G.appendChild(S),h.appendChild(G);var j=document.createElement("a");j.className="btn-floating orange accent-4 waves-effect waves-light",j.id="drawingDxf";var q=document.createElement("i");q.className="material-icons",q.innerHTML="save";var Y=document.createElement("li");j.appendChild(q),Y.appendChild(j),h.appendChild(Y);var K=document.createElement("a");K.className="btn-floating teal darken-2 waves-effect waves-light",K.id="convertTool";var U=document.createElement("i");U.className="material-icons",U.innerHTML="find_replace";var X=document.createElement("li");K.appendChild(U),X.appendChild(K),h.appendChild(X);var J=document.createElement("a");J.className="btn-floating grey darken-1 darken-2 waves-effect waves-light",J.id="drawingSetting";var Q=document.createElement("i");Q.className="material-icons",Q.innerHTML="format_list_bulleted";var V=document.createElement("li");J.appendChild(Q),V.appendChild(J),g.appendChild(u),g.appendChild(h);var ee=document.createElement("div");ee.style.bottom=window.innerHeight/2-70+"px",ee.style.right="33px",ee.style.zIndex=1,ee.style.position="absolute",ee.id="zoomDiv";var te=document.createElement("ul"),ae=document.createElement("li");ae.style.marginBottom="10px";var ne=document.createElement("a");ne.id="zoomIn",ne.className="btn-floating blue-grey waves-effect waves-light";var oe=document.createElement("i");oe.className="material-icons",oe.innerHTML="add",ne.appendChild(oe),ae.appendChild(ne),te.appendChild(ae);var le=document.createElement("li");le.style.marginBottom="10px";var ie=document.createElement("a");ie.id="zoomIndi",ie.className="btn-floating large grey center",ie.innerText=8,le.appendChild(ie),te.appendChild(le);var de=document.createElement("li"),se=document.createElement("a");se.id="zoomOut",se.className="btn-floating blue-grey waves-effect waves-light";var re=document.createElement("i");re.className="material-icons",re.innerHTML="remove",se.appendChild(re),de.appendChild(se),te.appendChild(de),ee.appendChild(te),document.body.appendChild(ee);var ce=document.createElement("div");ce.className="fixed-action-btn horizontal click-to-toggle",ce.style.bottom=window.innerHeight-101+"px",ce.style.right="24px",ce.id="mapTypeDiv",document.body.appendChild(ce);var me=document.createElement("a");me.className="btn-floating btn-large cyan waves-effect waves-light";var pe=document.createElement("i");pe.className="large material-icons",pe.innerHTML="burst_mode",me.appendChild(pe),ce.appendChild(me);var ge=document.createElement("ul");ce.appendChild(ge);var ue=document.createElement("a");ue.className="btn-floating red waves-effect waves-light",ue.id="mapTypeRoad";var ve=document.createElement("i");ve.className="material-icons",ve.innerHTML="grid_on";var he=document.createElement("li");ue.appendChild(ve),he.appendChild(ue),ge.appendChild(he);var ye=document.createElement("a");ye.className="btn-floating blue waves-effect waves-light",ye.id="mapTypeSatellite";var fe=document.createElement("i");fe.className="material-icons",fe.innerHTML="public";var we=document.createElement("li");ye.appendChild(fe),we.appendChild(ye),ge.appendChild(we);var Le=document.createElement("a");Le.className="btn-floating green waves-effect waves-light",Le.id="mapTypeMix";var Ee=document.createElement("i");Ee.className="material-icons",Ee.innerHTML="collections";var be=document.createElement("li");Le.appendChild(Ee),be.appendChild(Le),ge.appendChild(be);var Te=document.createElement("div");Te.className="fixed-action-btn click-to-toggle",Te.style.bottom="46px",Te.style.right=window.innerWidth-79+"px",Te.id="mapMenuDiv",document.body.appendChild(Te);var Me=document.createElement("a");Me.className="btn-floating btn-large green darken-1 waves-effect waves-light";var Ce=document.createElement("i");Ce.className="large material-icons",Ce.innerHTML="settings",Me.appendChild(Ce),Te.appendChild(Me);var xe=document.createElement("ul");Te.appendChild(xe);var Ie=document.createElement("a");Ie.className="btn-floating red waves-effect waves-light modal-trigger",Ie.id="menuInfo",Ie.href="#manu";var Ne=document.createElement("i");Ne.className="material-icons",Ne.innerHTML="priority_high";var Oe=document.createElement("li");Ie.appendChild(Ne),Oe.appendChild(Ie),xe.appendChild(Oe);var Ae=document.createElement("a");Ae.className="btn-floating blue waves-effect waves-light",Ae.id="aboutMe";var ke=document.createElement("i");ke.className="material-icons",ke.innerHTML="person";var Pe=document.createElement("li");Ae.appendChild(ke),Pe.appendChild(Ae),xe.appendChild(Pe);var He=document.createElement("div");He.style.top="46px",He.style.left="24px",He.style.zIndex=2,He.style.position="absolute",He.className="chip",He.style.opacity=.8;var Be=document.createElement("a");Be.href="index.html";var We=document.createElement("img");We.src="img/logo.png";var De=document.createTextNode("MapCADer");Be.appendChild(We),Be.appendChild(De),He.appendChild(Be),document.body.appendChild(He),window.addEventListener("resize",function(){c.style.height=window.innerHeight+"px",c.style.width=window.innerWidth+"px",document.getElementById("zoomDiv").style.bottom=window.innerHeight/2-70+"px",document.getElementById("mapTypeDiv").style.bottom=window.innerHeight-101+"px",document.getElementById("mapMenuDiv").style.right=window.innerWidth-79+"px"}),google.maps.event.addDomListener(window,"resize",function(){google.maps.event.trigger(m,"resize"),m.setCenter(p)});var ze=document.createElement("div");ze.style.top=window.innerHeight/4+"px",ze.style.left="24px",ze.style.position="absolute",ze.id="infoWindow",ze.style.display="none",ze.style.padding="10px",ze.className="ui-widget-content z-depth-2",document.body.appendChild(ze),$("#infoWindow").draggable({containment:$("#mapCanvas"),cancel:"table",handle:"#infoWindowMovingIcon"});var Fe=document.createElement("div");Fe.id="mapViewDiv",Fe.className="modal modal-fixed-footer row";var Re=document.createElement("div");Re.className="modal-content col s12 center";var _e=document.createElement("img");_e.className="responsive-img",_e.id="mapImageImg";var Se=document.createElement("div");Se.className="modal-footer";var $e=document.createElement("a");$e.href="#!",$e.className="modal-action modal-close waves-effect red btn-flat white-text",$e.innerHTML="離開",Se.appendChild($e),Fe.appendChild(Re),Fe.appendChild(Se),Re.appendChild(_e),document.body.appendChild(Fe);var Ze=new google.maps.drawing.DrawingManager({drawingControl:!1,drawingControlOptions:{drawingModes:[google.maps.drawing.OverlayType.MARKER,google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.RECTANGLE]},map:m,markerOptions:{animation:google.maps.Animation.DROP},polygonOptions:{strokeWeight:4,strokeColor:"#03a9f4",strokeOpacity:.8,fillColor:"#455a64",fillOpacity:.7,editable:!0},polylineOptions:{strokeWeight:4,strokeColor:"#4caf50",strokeOpacity:.8,editable:!0},rectangleOptions:{editable:!1,strokeWeight:4,strokeColor:"#ffff00",fillColor:"#455a64",strokeOpacity:.8,draggable:!0}});document.getElementById("drawingPoint").addEventListener("click",function(){Ze.setDrawingMode(google.maps.drawing.OverlayType.MARKER)}),google.maps.event.addListener(Ze,"markercomplete",function(e){setTimeout(function(){addNewPoint(e,n,a,m),a++},200)}),document.getElementById("movingMode").addEventListener("click",function(){Ze.setDrawingMode("")}),document.getElementById("drawingPolyline").addEventListener("click",function(){Ze.setDrawingMode(google.maps.drawing.OverlayType.POLYLINE)}),google.maps.event.addListener(Ze,"polylinecomplete",function(e){l.push(e),addNewLine(e,m,l,o,i),o++}),document.getElementById("drawingPolygon").addEventListener("click",function(){Ze.setDrawingMode(google.maps.drawing.OverlayType.POLYGON)}),google.maps.event.addListener(Ze,"polygoncomplete",function(e){s.push(e),addNewPolyline(e,m,s,d,r),d++}),S.addEventListener("click",function(){Ze.setDrawingMode(google.maps.drawing.OverlayType.RECTANGLE)});var Ge=new google.maps.Rectangle,je=!1;google.maps.event.addListener(Ze,"rectanglecomplete",function(e){je=!1,$("#toast-container").remove(),Ge.setMap(null),Ge=e;var t,a;polygonZoomChanged(e,m,t,a),Ge.addListener("dragend",function(){$("#toast-container").remove(),polygonZoomChanged(Ge,m,t,a)});var n=m.addListener("zoom_changed",function(){0==je&&($("#toast-container").remove(),polygonZoomChanged(e,m,t,a))});e.addListener("rightclick",function(){je=!0,e.setMap(null),$("#toast-container").remove(),google.maps.event.removeListener(n)})});var qe=document.createElement("div");qe.style.position="absolute",qe.style.display="none",qe.style.backgroundColor="#37474f",qe.style.zIndex=1010,qe.style.padding="10px",qe.style.borderRadius="10px",qe.className="z-depth-2";var Ye=document.createElement("form");Ye.action="#";var Ke=document.createElement("p"),Ue=document.createElement("input");Ue.name="group1",Ue.type="radio",Ue.id="dxfOptionLatLng",Ue.setAttribute("checked","");var Xe=document.createElement("label");Xe.setAttribute("for","dxfOptionLatLng"),Xe.innerHTML="經緯度",Ke.appendChild(Ue),Ke.appendChild(Xe);var Je=document.createElement("p"),Qe=document.createElement("input");Qe.name="group1",Qe.type="radio",Qe.id="dxfOptionTWD97";var Ve=document.createElement("label");Ve.setAttribute("for","dxfOptionTWD97"),Ve.innerHTML="TWD97",Je.appendChild(Qe),Je.appendChild(Ve);var et=document.createElement("p"),tt=document.createElement("input");tt.name="group1",tt.type="radio",tt.id="dxfOptionTWD97O";var at=document.createElement("label");at.setAttribute("for","dxfOptionTWD97O"),at.innerHTML="優化TWD97",et.appendChild(tt),et.appendChild(at),Ye.appendChild(Ke),Ye.appendChild(Je),Ye.appendChild(et);var nt=document.createElement("p");nt.style.fontWeight=800,nt.className="grey-text",nt.innerHTML="請選擇輸出坐標格式",qe.appendChild(nt),qe.appendChild(Ye),document.body.appendChild(qe),$("form").css("font-weight",800);var ot,lt;j.addEventListener("click",function(){document.getElementById("dxfOptionLatLng").checked&&exportGeometryData(lt,0),document.getElementById("dxfOptionTWD97").checked&&exportGeometryData(lt,1),document.getElementById("dxfOptionTWD97O").checked&&exportGeometryData(lt,2)}),j.addEventListener("mouseenter",function(){lt=collectGeometryData(n,l,s),qe.style.top=j.getBoundingClientRect().top-220+"px",qe.style.left=j.getBoundingClientRect().left-100+"px",ot=setTimeout(function(){qe.style.display="block",qe.classList.remove("zoomOut"),qe.classList.add("animated","bounceIn")},700)}),j.addEventListener("mouseleave",function(){clearTimeout(ot),dxfLeaveTimeout=setTimeout(function(){qe.classList.remove("bounceIn"),qe.classList.add("zoomOut")},700)}),qe.addEventListener("mouseenter",function(){clearTimeout(dxfLeaveTimeout)}),qe.addEventListener("mouseleave",function(){dxfLeaveTimeout=setTimeout(function(){qe.classList.remove("bounceIn"),qe.classList.add("zoomOut")},100)}),document.getElementById("mapTypeRoad").addEventListener("click",function(){m.setMapTypeId(google.maps.MapTypeId.ROADMAP)}),document.getElementById("mapTypeSatellite").addEventListener("click",function(){m.setMapTypeId(google.maps.MapTypeId.SATELLITE)}),document.getElementById("mapTypeMix").addEventListener("click",function(){m.setMapTypeId(google.maps.MapTypeId.HYBRID)}),document.getElementById("zoomIn").addEventListener("click",function(){var e=parseInt(ie.innerHTML);19>e&&(m.setZoom(e+1),ie.innerHTML=e+1)}),document.getElementById("zoomOut").addEventListener("click",function(){var e=parseInt(ie.innerHTML);e>1&&(m.setZoom(e-1),ie.innerHTML=e-1)}),google.maps.event.addListener(m,"zoom_changed",function(e){ie.innerHTML=m.getZoom()});var it=document.createElement("div");it.id="convertorDiv",it.className="modal modal-fixed-footer col s12";var dt=document.createElement("div");dt.className="modal-content row";var st=document.createElement("a");st.className="waves-effect waves-light btn-floating btn-large green white-text",st.herf="#!",st.innerHTML='<i class="material-icons">add</i>',st.id="convertorAddBtn";var rt=document.createElement("h3");rt.className="center teal-text",rt.style.fontWeight=800,rt.innerHTML="坐標轉換";var ct=document.createElement("div");ct.className="input-field col s11",ct.style.paddingLeft=0;var mt=document.createElement("input");
mt.id="coordinateInputBtn",mt.type="text",mt.className="validate";var pt=document.createElement("label");pt["for"]="coordinateInputBtn",pt.innerHTML="請輸入坐標或地址";var gt=document.createElement("table");gt.className="col s12 striped bordered",gt.id="coordinateTableDiv";var ut=document.createElement("tbody"),vt=document.createElement("tr"),ht=document.createElement("tr"),yt=document.createElement("tr"),ft=document.createElement("tr"),wt=document.createElement("td");wt.id="tdLatLng";var Lt=document.createElement("td");Lt.innerHTML="轉換後經緯度坐標:";var Et=document.createElement("td");Et.id="tdTWD";var bt=document.createElement("td");bt.innerHTML="轉換後TWD97坐標:";var Tt=document.createElement("td");Tt.id="tdTWDO";var Mt=document.createElement("td");Mt.innerHTML="轉換後TWD97(優化)坐標:";var Ct=document.createElement("td");Ct.id="tdAddress";var xt=document.createElement("td");xt.innerHTML="轉換後地址:";var It=document.createElement("div");It.className="modal-footer";var Nt=document.createElement("a");Nt.href="#!",Nt.className="modal-action modal-close waves-effect red btn-flat white-text",Nt.innerHTML="離開",It.appendChild(Nt),ut.appendChild(vt).appendChild(Lt),vt.appendChild(wt),ut.appendChild(yt).appendChild(bt),yt.appendChild(Et),ut.appendChild(ft).appendChild(Mt),ft.appendChild(Tt),ut.appendChild(ht).appendChild(xt),ht.appendChild(Ct),gt.appendChild(ut),ct.appendChild(mt),ct.appendChild(pt),dt.appendChild(rt),dt.appendChild(ct),dt.appendChild(st),dt.appendChild(gt),it.appendChild(dt),it.appendChild(It),document.body.appendChild(it),document.getElementById("convertTool").addEventListener("click",function(){$("#convertorDiv").openModal()}),document.getElementById("coordinateInputBtn").addEventListener("input",function(){var a,n,o=new google.maps.Geocoder;if(-1!=this.value.indexOf(",")){if(a=parseFloat(this.value.trim().substring(0,this.value.trim().indexOf(","))),n=parseFloat(this.value.trim().substring(this.value.trim().indexOf(",")+1,this.value.trim().length)),n>=21&&26>=n&&a>=120&&122>=a){e=n,t=a,wt.innerHTML=a.toFixed(6)+","+n.toFixed(6);var l=converTo97(n,a,.9999),i=converTo97(n,a,.999941);Et.innerHTML=l.N+","+l.E,Tt.innerHTML=i.N+","+i.E,setTimeout(function(){o.geocode({location:{lat:n,lng:a}},function(e,t){t===google.maps.GeocoderStatus.OK?Ct.innerHTML=e[0].formatted_address:t===google.maps.GeocoderStatus.ZERO_RESULTS&&(Ct.innerHTML="搜尋不到相關地址坐標!")})},500)}if(a>=2e6&&n>=1e5){var d=convertToLatLng(n,a,.9999),s=converTo97(d.Lat,d.Lng,.999941);wt.innerHTML=d.Lng.toFixed(6)+","+d.Lat.toFixed(6),Et.innerHTML=a.toFixed(6)+","+n.toFixed(6),Tt.innerHTML=s.N+","+s.E,e=d.Lat,t=d.Lng,setTimeout(function(){o.geocode({location:{lat:d.Lat,lng:d.Lng}},function(e,t){t===google.maps.GeocoderStatus.OK?Ct.innerHTML=e[0].formatted_address:t===google.maps.GeocoderStatus.ZERO_RESULTS&&(Ct.innerHTML="搜尋不到相關地址坐標!")})},500)}}else if(-1==this.value.indexOf(",")&&""!=this.value){var r=this.value.trim();Ct.innerHTML=r,setTimeout(function(){o.geocode({address:r},function(a,n){if(n===google.maps.GeocoderStatus.OK){wt.innerHTML=a[0].geometry.location.lng().toFixed(6)+","+a[0].geometry.location.lat().toFixed(6),e=a[0].geometry.location.lat(),t=a[0].geometry.location.lng();var o=converTo97(a[0].geometry.location.lat(),a[0].geometry.location.lng(),.9999),l=converTo97(a[0].geometry.location.lat(),a[0].geometry.location.lng(),.999941);Et.innerHTML=o.N+","+o.E,Tt.innerHTML=l.N+","+l.E}else n===google.maps.GeocoderStatus.ZERO_RESULTS&&(Ct.innerHTML="搜尋不到相關地址坐標!")})},500)}else""==this.value&&(wt.innerHTML="",Et.innerHTML="",Tt.innerHTML="",Ct.innerHTML="")}),document.getElementById("convertorAddBtn").addEventListener("click",function(){if(-1!=mt.value.indexOf(",")&&""!=mt.value){var o=new google.maps.Marker({position:{lat:e,lng:t},map:m});m.setCenter({lat:e,lng:t}),m.setZoom(16),ie.innerHTML=16,setTimeout(function(){addNewPoint(o,n,a,m),a++},500)}else if(-1==mt.value.indexOf(",")&&""!=mt.value){var o=new google.maps.Marker({position:{lat:e,lng:t},map:m});m.setCenter({lat:e,lng:t}),m.setZoom(16),ie.innerHTML=16,setTimeout(function(){addNewPoint(o,n,a,m),a++},500)}}),T.style.top=L.getBoundingClientRect().top-97+"px",T.style.left=L.getBoundingClientRect().left+"px";var Ot,At;L.addEventListener("mouseover",function(){Ot=setTimeout(function(){T.style.display="block",T.classList.remove("zoomOut"),T.classList.add("animated","bounceIn")},750)}),L.addEventListener("mouseleave",function(){clearTimeout(Ot),At=setTimeout(function(){T.classList.remove("bounceIn"),T.classList.add("zoomOut")},1e3)}),T.addEventListener("mouseover",function(){clearTimeout(At)}),T.addEventListener("mouseleave",function(){clearTimeout(At),clearTimeout(Ot),T.classList.remove("bounceIn"),T.classList.add("zoomOut")}),T.addEventListener("click",function(){for(var e=0;e<n.length;e++)n[e].setMap(null);a=0,n=[],infoWindowCloseIconA.click()}),C.style.top=L.getBoundingClientRect().top-48+"px",C.style.left=L.getBoundingClientRect().left+"px";var kt,Pt;L.addEventListener("mouseover",function(){kt=setTimeout(function(){C.style.display="block",C.classList.remove("zoomOut"),C.classList.add("animated","bounceIn")},700)}),L.addEventListener("mouseleave",function(){clearTimeout(kt),Pt=setTimeout(function(){C.classList.remove("bounceIn"),C.classList.add("zoomOut")},1e3)}),C.addEventListener("mouseover",function(){clearTimeout(Pt)}),C.addEventListener("mouseleave",function(){clearTimeout(Pt),clearTimeout(kt),C.classList.remove("bounceIn"),C.classList.add("zoomOut")}),C.addEventListener("click",function(){}),A.style.top=I.getBoundingClientRect().top-97+"px",A.style.left=I.getBoundingClientRect().left+"px";var Ht,Bt;I.addEventListener("mouseover",function(){Ht=setTimeout(function(){A.style.display="block",A.classList.remove("zoomOut"),A.classList.add("animated","bounceIn")},750)}),I.addEventListener("mouseleave",function(){clearTimeout(Ht),Bt=setTimeout(function(){A.classList.remove("bounceIn"),A.classList.add("zoomOut")},1e3)}),A.addEventListener("mouseover",function(){clearTimeout(Bt)}),A.addEventListener("mouseleave",function(){clearTimeout(Bt),clearTimeout(Ht),A.classList.remove("bounceIn"),A.classList.add("zoomOut")}),A.addEventListener("click",function(){for(var e=0;e<l.length;e++)l[e].setMap(null),i[e].setMap(null);o=0,l=[],i=[],infoWindowCloseIconA.click()}),P.style.top=I.getBoundingClientRect().top-48+"px",P.style.left=I.getBoundingClientRect().left+"px";var Wt,Dt;I.addEventListener("mouseover",function(){Wt=setTimeout(function(){P.style.display="block",P.classList.remove("zoomOut"),P.classList.add("animated","bounceIn")},700)}),I.addEventListener("mouseleave",function(){clearTimeout(Wt),Dt=setTimeout(function(){P.classList.remove("bounceIn"),P.classList.add("zoomOut")},1e3)}),P.addEventListener("mouseover",function(){clearTimeout(Dt)}),P.addEventListener("mouseleave",function(){clearTimeout(Dt),clearTimeout(Wt),P.classList.remove("bounceIn"),P.classList.add("zoomOut")}),P.addEventListener("click",function(){}),z.style.top=B.getBoundingClientRect().top-97+"px",z.style.left=B.getBoundingClientRect().left+"px";var zt,Ft;B.addEventListener("mouseover",function(){zt=setTimeout(function(){z.style.display="block",z.classList.remove("zoomOut"),z.classList.add("animated","bounceIn")},750)}),B.addEventListener("mouseleave",function(){clearTimeout(zt),Ft=setTimeout(function(){z.classList.remove("bounceIn"),z.classList.add("zoomOut")},1e3)}),z.addEventListener("mouseover",function(){clearTimeout(Ft)}),z.addEventListener("mouseleave",function(){clearTimeout(Ft),clearTimeout(zt),z.classList.remove("bounceIn"),z.classList.add("zoomOut")}),z.addEventListener("click",function(){for(var e=0;e<s.length;e++)s[e].setMap(null),r[e].setMap(null);d=0,s=[],r=[],infoWindowCloseIconA.click()}),R.style.top=B.getBoundingClientRect().top-48+"px",R.style.left=B.getBoundingClientRect().left+"px";var Rt,_t;B.addEventListener("mouseover",function(){Rt=setTimeout(function(){R.style.display="block",R.classList.remove("zoomOut"),R.classList.add("animated","bounceIn")},700)}),B.addEventListener("mouseleave",function(){clearTimeout(Rt),_t=setTimeout(function(){R.classList.remove("bounceIn"),R.classList.add("zoomOut")},1e3)}),R.addEventListener("mouseover",function(){clearTimeout(_t)}),R.addEventListener("mouseleave",function(){clearTimeout(_t),clearTimeout(Rt),R.classList.remove("bounceIn"),R.classList.add("zoomOut")}),R.addEventListener("click",function(){});var St=document.createElement("div");St.id="addMultiObjDiv",St.className="modal modal-fixed-footer col s12";var $t=document.createElement("div");$t.className="modal-content row";var Zt=document.createElement("a");Zt.className="waves-effect waves-light btn-floating btn-large red white-text",Zt.herf="#!",Zt.innerHTML='<i class="material-icons">add</i>',Zt.id="addMultiPointBtn",Zt.style.display="none";var Gt=document.createElement("a");Gt.className="waves-effect waves-light btn-floating btn-large green white-text",Gt.herf="#!",Gt.innerHTML='<i class="material-icons">add</i>',Gt.id="addMultiLineBtn",Gt.style.display="none";var jt=document.createElement("a");jt.className="waves-effect waves-light btn-floating btn-large blue white-text",jt.herf="#!",jt.innerHTML='<i class="material-icons">add</i>',jt.id="addMultiPolylineBtn",jt.style.display="none";var qt=document.createElement("h3");qt.className="center teal-text",qt.style.fontWeight=800,qt.innerHTML="新增多幾何物件";var Yt=document.createElement("div");Yt.className="input-field col s11",Yt.style.paddingLeft=0;var Kt=document.createElement("textarea");Kt.id="addMultiObjInputBtn",Kt.className="materialize-textarea";var Ut=document.createElement("label");Ut["for"]="addMultiObjInputBtn",Ut.innerHTML="請輸入多物件坐標陣列";var Xt=document.createElement("div");Xt.className="modal-footer";var Jt=document.createElement("a");Jt.href="#!",Jt.className="modal-action modal-close waves-effect red btn-flat white-text",Jt.innerHTML="離開",Xt.appendChild(Jt),Yt.appendChild(Kt),Yt.appendChild(Ut),$t.appendChild(qt),$t.appendChild(Yt),$t.appendChild(Zt),$t.appendChild(Gt),$t.appendChild(jt),St.appendChild($t),St.appendChild(Xt),document.body.appendChild(St),C.addEventListener("click",function(){Zt.style.display="block",Gt.style.display="none",jt.style.display="none",$("#addMultiObjDiv").openModal()}),P.addEventListener("click",function(){Zt.style.display="none",Gt.style.display="block",jt.style.display="none",$("#addMultiObjDiv").openModal()}),R.addEventListener("click",function(){Zt.style.display="none",Gt.style.display="none",jt.style.display="block",$("#addMultiObjDiv").openModal()}),Zt.addEventListener("click",function(){var e=JSON.parse(Kt.value.trim());if(e)try{if(e.length%2==0)for(var t=0;t<e.length/2;t++)if(e[2*t]<123){var o=new google.maps.Marker({position:{lat:e[2*t+1],lng:e[2*t]},map:m});addNewPoint(o,n,a,m),a++}else{var l=convertToLatLng(e[2*t+1],e[2*t],.9999),o=new google.maps.Marker({position:{lat:l.Lat,lng:l.Lng},map:m});addNewPoint(o,n,a,m),a++}}catch(i){}}),Gt.addEventListener("click",function(){var e=JSON.parse(Kt.value.trim());if(e)try{if(e.length>0)for(var t=0;t<e.length;t++){for(var a=[],n=0;n<e[t].length/2;n++)if(e[t][2*n]<123)a.push(new google.maps.LatLng(parseFloat(e[t][2*n+1]),parseFloat(e[t][2*n])));else if(e[t][2*n]>123){var d=convertToLatLng(e[t][2*n+1],e[t][2*n],.9999);a.push(new google.maps.LatLng(parseFloat(d.Lat),parseFloat(d.Lng)))}var s=new google.maps.Polyline({path:a,strokeWeight:4,strokeColor:"#4caf50",strokeOpacity:.8,editable:!0,map:m});addNewLine(s,m,l,o,i),l.push(s),o++}}catch(r){}}),jt.addEventListener("click",function(){var e=JSON.parse(Kt.value.trim());if(e)try{if(e.length>0)for(var t=0;t<e.length;t++){for(var a=[],n=0;n<e[t].length/2;n++)if(e[t][2*n]<123)n<e[t].length/2-1?a.push(new google.maps.LatLng(parseFloat(e[t][2*n+1]),parseFloat(e[t][2*n]))):n==e[t].length/2-1&&(a.push(new google.maps.LatLng(parseFloat(e[t][2*n+1]),parseFloat(e[t][2*n]))),a.push(new google.maps.LatLng(parseFloat(e[t][1]),parseFloat(e[t][0]))));else if(e[t][2*n]>123)if(n<e[t].length/2-1){var o=convertToLatLng(e[t][2*n+1],e[t][2*n],.9999);a.push(new google.maps.LatLng(parseFloat(o.Lat),parseFloat(o.Lng)))}else if(n==e[t].length/2-1){var o=convertToLatLng(e[t][2*n+1],e[t][2*n],.9999);a.push(new google.maps.LatLng(parseFloat(o.Lat),parseFloat(o.Lng)));var l=convertToLatLng(e[t][1],e[t][0],.9999);a.push(new google.maps.LatLng(parseFloat(l.Lat),parseFloat(l.Lng)))}var i=new google.maps.Polygon({paths:a,strokeWeight:4,strokeColor:"#03a9f4",strokeOpacity:.8,fillColor:"#455a64",fillOpacity:.7,editable:!0,map:m});s.push(i),addNewPolyline(i,m,s,d,r),d++}}catch(c){}}),$("#menuInfo").on("click",function(){0!=$("#shadowInfoWindow").length&&(document.getElementById("shadowInfoWindow").style.display="none"),$("body").append("<div id='manu' class='modal' style='max-height:85% ;width:70%;'><div class='modal-content  z-depth-2'><h3 class='center cyan-text' style=\"font-weight: 800\">網站使用說明：</h3><ul class=\"collapsible popout\" data-collapsible=\"accordion\"><li><div class=\"collapsible-header\"><i class=\"red-text material-icons\">add_location</i>新增點位</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='FsWcZ4Bgq3s'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"red-text material-icons\">delete</i>刪除單一與多個點位</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='HJHeHx1XBps'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"red-text material-icons\">add</i>新增多個點位</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='5m-iQQArWMk'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"green-text material-icons\">timeline</i>新增線段</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='kQnOPMSGvmk'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"green-text material-icons\">delete</i>刪除單一線段與所有線段</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='-b6PXKqqhbo'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"green-text material-icons\">add</i>新增多條線段</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='aZA_uA_Z7wE'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"blue-text material-icons\">crop_5_4</i>新增多邊形</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='_ESwajD0CSU'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"blue-text material-icons\">delete</i>刪除單一與所有多邊形</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='zSIl0PXdBH4'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"blue-text material-icons\">add</i>新增複數多邊形</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='2TvTMKpPdfg'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"yellow-text material-icons\">camera_alt</i>地圖影像輸出</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='dSGAJAUYGHY'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"yellow-text material-icons\">camera_alt</i>地圖影像輸出-影像切換與其他操作</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='-ZsdWoPFMFc'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"orange-text material-icons\">save</i>輸出dxf檔</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='bBDCvI28Kww'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"teal-text material-icons\">find_replace</i>點位搜尋與坐標轉化</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='tc93lagcbg8'></div></div></div></li><li><div class=\"collapsible-header\"><i class=\"cyan-text material-icons\">burst_mode</i>地圖切換與地圖縮放</div><div class=\"collapsible-body center\"><div class='youtube-container'><div class='youtube-player' data-id='f32mp3aVh8o'></div></div></div></li>  </ul></div><div class='modal-footer'><a href='#!' class=\"modal-action modal-close waves-effect red white-text btn-flat\">離開</a></div></div></div>"),youtubeMinify(),$(".collapsible").collapsible({accordion:!1})}),void 0==Cookies.get("visit")?setTimeout(function(){var e=document.createElement("div");e.id="shadowInfoWindow",e.className="card animated fadeInRight Infinite",e.innerHTML='<h4 style="padding-left:10px;padding-right:10px"> 第一次拜訪網站，請點擊 <a class="btn-floating red"><i class="white-text material-icons">priority_high</i></a> 按鈕觀看說明 </h4>',e.style.top=Ie.getBoundingClientRect().top+"px",e.style.left=Ie.getBoundingClientRect().left+100+"px",e.style.borderRadius="12px",document.body.appendChild(e)},1e3):1==Cookies.get("visit"),$("div").on("click",function(){0!=$("#shadowInfoWindow").length&&(document.getElementById("shadowInfoWindow").style.display="none")}),$("body").append("<div id='bio' class='modal modal-fixed-footer'><div class='modal-content'><div class='card'><div class='card-content'> <sapn class='card-title'>關於網站</sapn><p>目前網頁仍在建制中，如果有任何建議，請email至:chenghungko@gmail.com </p></div></div></div><div class='modal-footer'><a href='#!' class=\"modal-action modal-close waves-effect red white-text btn-flat\">離開</a></div></div>"),$("#aboutMe").on("click",function(){$("#bio").openModal()})};var coor97={a:6378137,b:6356752.31414,e2:.00669438,eplus2:.00673949675,X0:25e4,Y0:0},zoomScale=[];zoomScale[0]=591657550.5;for(var i=1;21>i;i++)zoomScale[i]=zoomScale[i-1]/2;